<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice.Assembly.FM - Ctrl</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Mono', Monaco, 'Courier New', monospace;
            background: #0a0a0a;
            color: #f0f0f0;
            padding: 15px;
            min-height: 100vh;
            font-size: 11px;
            overflow-x: auto;
            user-select: none;
            -webkit-user-select: none;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 14px;
            font-weight: normal;
            margin-bottom: 4px;
            color: #f0f0f0;
            text-transform: lowercase;
        }

        .header .subtitle {
            color: #444;
            font-size: 10px;
            text-transform: lowercase;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 220px 1fr 220px;
            grid-template-rows: auto auto;
            gap: 15px;
            min-width: 1200px;
            max-width: 100vw;
        }

        .panel {
            background: #000;
            border: 1px solid #222;
            padding: 10px;
            overflow-y: auto;
            max-height: 80vh;
        }

        .panel.narrow {
            min-width: 200px;
        }

        /* Parameters panel optimizations */
        .panel:nth-child(2) {
            /* Parameters panel - center column, make wider for parameters */
            min-width: 600px;
        }

        /* Responsive grid for smaller screens */
        @media (max-width: 1400px) {
            .main-grid {
                grid-template-columns: 180px 1fr 180px;
                min-width: 1000px;
            }
        }

        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
                grid-template-rows: repeat(6, auto);
                min-width: 800px;
            }
            
            .panel {
                max-height: none;
            }
        }

        .panel h2 {
            font-size: 10px;
            font-weight: normal;
            margin-bottom: 10px;
            color: #444;
            text-align: center;
            text-transform: lowercase;
            border-bottom: 1px solid #222;
            padding-bottom: 6px;
        }

        /* Visual distinction for parameter panel */
        .panel:nth-child(2) h2 {
            color: #666;
            border-bottom-color: #333;
        }

        /* Grid layout helper - visual grouping */
        .main-grid > .panel:nth-child(1),
        .main-grid > .panel:nth-child(2),
        .main-grid > .panel:nth-child(3) {
            /* Top row panels */
            border-top: 1px solid #222;
        }

        .main-grid > .panel:nth-child(4),
        .main-grid > .panel:nth-child(5),
        .main-grid > .panel:nth-child(6) {
            /* Bottom row panels */
            border-top: 1px solid #111;
        }

        .status-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .status-item {
            background: #0a0a0a;
            padding: 6px;
            border: 1px solid #222;
        }

        .status-item.connected {
            color: #666;
        }

        .status-label {
            font-size: 9px;
            color: #444;
            margin-bottom: 2px;
            text-transform: lowercase;
        }

        .status-value {
            font-size: 11px;
            font-weight: normal;
        }

        .control-section {
            margin-bottom: 10px;
        }

        .control-section h3 {
            font-size: 9px;
            color: #444;
            margin-bottom: 6px;
            text-transform: lowercase;
            font-weight: normal;
        }

        .button {
            background: #111;
            border: 1px solid #333;
            color: #666;
            padding: 6px 12px;
            cursor: pointer;
            font-size: 11px;
            font-family: inherit;
            font-weight: normal;
            transition: all 0.1s;
        }

        .button:hover {
            background: #1a1a1a;
            color: #888;
        }

        .button:disabled {
            background: #0a0a0a;
            color: #333;
            border-color: #222;
            cursor: not-allowed;
        }

        .button.manual-mode-btn {
            width: 100%;
        }

        .button.manual-mode-btn.active {
            background: #222;
            border-color: #666;
            color: #fff;
            position: relative;
        }

        .button.manual-mode-btn.active::before {
            content: "‚óè";
            position: absolute;
            left: 8px;
            color: #fff;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .input-group {
            margin-bottom: 8px;
        }

        .peer-list {
            max-height: 120px;
            overflow-y: auto;
        }

        .peer-item {
            padding: 4px 8px;
            background: #0a0a0a;
            border: 1px solid #222;
            margin-bottom: 2px;
            font-size: 10px;
        }

        .peer-id {
            color: #f0f0f0;
        }

        .peer-type {
            color: #444;
        }

        .log {
            height: 100px;
            background: #0a0a0a;
            border: 1px solid #222;
            padding: 6px;
            font-family: inherit;
            font-size: 9px;
            overflow-y: auto;
            white-space: pre-wrap;
            color: #444;
        }

        /* Parameter Control Styles */
        .param-control {
            background: #0a0a0a;
            padding: 10px;
            border: 1px solid #222;
            margin-bottom: 8px;
        }

        /* Better parameter organization in wider space */
        .param-control .param-header {
            display: flex;
            justify-content: flex-start;
            align-items: center;
            margin-bottom: 8px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .param-control .param-main {
            display: grid;
            grid-template-columns: 40px 1fr 80px;
            align-items: center;
            gap: 8px;
        }
        
        .param-row {
            display: grid;
            grid-template-columns: 40px 1fr 80px;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .param-label {
            font-size: 9px;
            color: #444;
            margin-bottom: 4px;
            text-align: right;
            text-transform: lowercase;
            font-weight: normal;
            min-width: 40px;
        }

        .param-value {
            font-size: 11px;
            color: #f0f0f0;
            margin-bottom: 6px;
            text-align: center;
            font-weight: normal;
        }

        .slider {
            width: 100%;
            -webkit-appearance: none;
            height: 4px;
            background: #111;
            outline: none;
        }

        .slider:hover {
            background: #222;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            background: #666;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: #666;
            cursor: pointer;
            border: none;
        }

        /* Envelope Control Styles */
        .envelope-control {
            border-left: 1px solid transparent;
            padding-left: 8px;
        }

        .envelope-control.envelope-active {
            border-left-color: #666;
        }

        .param-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .static-checkbox {
            font-size: 10px;
            color: #444;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .static-checkbox input[type="checkbox"] {
            margin: 0;
            transform: scale(0.8);
        }

        .param-main {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .param-suffix {
            font-size: 9px;
            color: #333;
            min-width: 40px;
        }

        .envelope-section {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #222;
        }

        .param-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .param-row .param-label {
            min-width: 60px;
            font-size: 10px;
        }

        .param-row .param-value {
            min-width: 35px;
        }

        .envelope-controls {
            display: flex;
            gap: 20px;
            margin: 6px 0;
            font-size: 10px;
            align-items: center;
            justify-content: center;
        }

        .envelope-type {
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .envelope-type label {
            color: #444;
            cursor: pointer;
            margin-right: 8px;
        }
        
        .envelope-intensity {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .envelope-type input[type="radio"] {
            margin-right: 3px;
            transform: scale(0.8);
        }

        .envelope-intensity {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .small-slider {
            width: 60px;
        }

        .param-value.small {
            font-size: 9px;
            min-width: 25px;
        }

        
        /* HRG Controls Styling */
        .hrg-controls {
            margin: 8px 0;
            padding: 8px;
            background-color: #0a0a0a;
            border: 1px solid #222;
        }
        
        .hrg-row {
            display: flex;
            align-items: center;
            margin: 4px 0;
            gap: 8px;
        }
        
        .hrg-row label {
            width: 80px;
            font-size: 10px;
            color: #444;
        }
        
        .hrg-row input[type="text"] {
            flex: 1;
            padding: 2px 4px;
            background-color: #111;
            border: 1px solid #333;
            color: #f0f0f0;
            font-size: 10px;
        }
        
        .hrg-row select {
            flex: 1;
            padding: 2px 4px;
            background-color: #111;
            border: 1px solid #333;
            color: #f0f0f0;
            font-size: 10px;
        }

        /* Compact HRG Styles */
        .hrg-compact .hrg-mode select {
            font-size: 10px;
            padding: 1px 2px;
            margin-bottom: 2px;
        }
        
        .hrg-compact-line {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 10px;
            margin: 1px 0;
        }
        
        .hrg-compact-line span {
            color: #444;
            font-size: 9px;
            min-width: 12px;
        }
        
        .hrg-compact-line input[type="text"] {
            flex: 1;
            padding: 1px 3px;
            font-size: 9px;
            background-color: #111;
            border: 1px solid #333;
            color: #f0f0f0;
            min-width: 60px;
        }
        
        .hrg-compact-line select {
            padding: 1px 2px;
            font-size: 8px;
            background-color: #111;
            border: 1px solid #333;
            color: #f0f0f0;
            min-width: 25px;
        }

        /* Randomizer Styles */
        .randomizer-toggle {
            font-size: 14px;
            cursor: pointer;
            padding: 2px 4px;
            margin-left: 6px;
            color: #333;
            user-select: none;
            transition: color 0.1s;
        }
        
        .randomizer-toggle:hover {
            color: #666;
        }
        
        .randomizer-toggle.active {
            color: #666;
        }
        
        .randomizer-inline-range {
            display: none;
            font-size: 9px;
            margin-left: 4px;
            color: #444;
        }
        
        .randomizer-inline-range.show {
            display: inline;
        }
        
        .randomizer-inline-range input {
            width: 30px;
            font-size: 8px;
            background: #111;
            border: 1px solid #333;
            color: #f0f0f0;
            padding: 1px 2px;
            margin: 0 1px;
        }

        /* Dual-Handle Range Slider */
        .dual-range-slider {
            position: relative;
            width: 100%;
            height: 20px;
            margin: 0;
        }
        
        .dual-range-slider .range-min,
        .dual-range-slider .range-max {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 20px;
            -webkit-appearance: none;
            background: transparent;
            outline: none;
            pointer-events: none;
            z-index: 2;
        }
        
        .dual-range-slider .range-min::-webkit-slider-thumb,
        .dual-range-slider .range-max::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: #666;
            cursor: pointer;
            pointer-events: all;
            z-index: 3;
        }
        
        .dual-range-slider .range-min::-moz-range-thumb,
        .dual-range-slider .range-max::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: #4a7c8a;
            border-radius: 50%;
            cursor: pointer;
            pointer-events: all;
            border: none;
            box-shadow: 0 1px 3px rgba(0,0,0,0.3);
        }
        
        .slider-track {
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 4px;
            background: #333;
            border-radius: 2px;
            transform: translateY(-50%);
            z-index: 1;
        }
        
        .slider-range {
            position: absolute;
            top: 50%;
            height: 4px;
            background: #4a7c8a;
            border-radius: 2px;
            transform: translateY(-50%);
            z-index: 1;
            transition: all 0.1s ease;
        }
        
        /* Static mode: single handle appearance */
        .dual-range-slider[data-mode="static"] .slider-range {
            background: transparent;
        }
        
        .dual-range-slider[data-mode="static"] .range-max::-webkit-slider-thumb {
            opacity: 0;
            pointer-events: none;
        }
        
        .dual-range-slider[data-mode="static"] .range-max::-moz-range-thumb {
            opacity: 0;
            pointer-events: none;
        }
        
        /* Range mode: dual handle appearance */
        .dual-range-slider[data-mode="range"] .range-max::-webkit-slider-thumb {
            opacity: 1;
            pointer-events: all;
        }
        
        .dual-range-slider[data-mode="range"] .range-max::-moz-range-thumb {
            opacity: 1;
            pointer-events: all;
        }
        
        /* Value display */
        .value-display {
            font-size: 12px;
            color: #e0e0e0;
            font-family: Monaco, monospace;
            min-width: 80px;
            text-align: center;
        }

        .randomizer-target {
            margin-bottom: 6px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .randomizer-target label {
            color: #888;
            font-size: 10px;
        }

        .randomizer-target select {
            background: #1a1a1a;
            border: 1px solid #444;
            color: #e0e0e0;
            padding: 2px 4px;
            font-size: 9px;
            font-family: inherit;
        }

        .randomizer-btn.active {
            background: #4a7c8a;
            border-color: #4a7c8a;
            color: #e0e0e0;
            animation: pulse-randomizer 2s infinite;
        }

        @keyframes pulse-randomizer {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        /* Phasor Bar Styles */
        .phasor-bar-container {
            background: #1a1a1a;
            border: 1px solid #444;
            height: 20px;
            position: relative;
            margin-bottom: 8px;
        }

        .phasor-bar {
            background: #4a7c8a;
            height: 100%;
            width: 0%;
            transition: none;
        }

        .phasor-value {
            font-size: 14px;
            color: #e0e0e0;
            text-align: center;
            font-weight: normal;
            font-family: Monaco, monospace;
        }

    </style>
</head>
<body>
    <div class="header">
        <h1>voice.assembly.fm</h1>
        <div class="subtitle">ctrl</div>
    </div>

    <div class="main-grid">
        <!-- Row 1: System Panel (narrow, left) -->
        <div class="panel narrow">
            <h2>system</h2>
            <div class="status-grid">
                <div class="status-item" id="connection-status">
                    <div class="status-label">connection</div>
                    <div class="status-value" id="connection-value">disconnected</div>
                </div>
                <div class="status-item" id="peers-status">
                    <div class="status-label">peers</div>
                    <div class="status-value" id="peers-value">0</div>
                </div>
            </div>
            
            <div class="control-section">
                <h3>peers</h3>
                <div class="peer-list" id="peer-list">
                    <div style="color: #888; font-size: 10px; text-align: center; padding: 8px;">
                        no peers
                    </div>
                </div>
            </div>
        </div>

        <!-- Row 1: Parameters Panel (wide, center) -->
        <div class="panel">
            <h2>parameters</h2>
            
            <div class="param-control envelope-control">
                <div class="param-header">
                    <div class="param-label">frequency</div>
                    <label class="static-checkbox">
                        <input type="checkbox" id="frequency-static" checked>
                        static
                    </label>
                </div>
                <div class="param-row">
                    <div class="param-label">start:</div>
                    <div class="dual-range-slider" data-mode="static" data-param="frequency" data-type="start">
                        <input type="range" class="range-min" id="frequency-start-min" 
                               min="80" max="800" step="1" value="220">
                        <input type="range" class="range-max" id="frequency-start-max" 
                               min="80" max="800" step="1" value="220">
                        <div class="slider-track"></div>
                        <div class="slider-range"></div>
                    </div>
                    <span class="value-display" id="frequency-start-display">220</span>
                    <button class="randomizer-btn" id="frequency-start-randomizer" title="Toggle HRG">[ hrg ]</button>
                    <div class="param-value" id="frequency-value" style="display: none;">220</div>
                    <div class="param-suffix" id="frequency-suffix" style="display: none;"> Hz</div>
                </div>
                
                <!-- HRG Controls for frequency start (hidden by default) -->
                <div class="hrg-controls hrg-compact" id="frequency-start-hrg-controls" style="display: none;">
                    <div class="hrg-inputs hrg-compact-inputs">
                        <div class="hrg-compact-line">
                            <span>n:</span><input type="text" id="frequency-start-numerators" value="1,2,3">
                            <select id="frequency-start-numerators-behavior">
                                <option value="static">s</option>
                                <option value="ascending">a</option>
                                <option value="descending">d</option>
                                <option value="shuffle">sh</option>
                                <option value="random">r</option>
                            </select>
                        </div>
                        <div class="hrg-compact-line">
                            <span>d:</span><input type="text" id="frequency-start-denominators" value="1,2">
                            <select id="frequency-start-denominators-behavior">
                                <option value="static">s</option>
                                <option value="ascending">a</option>
                                <option value="descending">d</option>
                                <option value="shuffle">sh</option>
                                <option value="random">r</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Envelope Controls (hidden when static) -->
                <div class="envelope-section" id="frequency-envelope">
                    <div class="param-row">
                        <div class="param-label">end:</div>
                        <div class="dual-range-slider" data-mode="static" data-param="frequency" data-type="end">
                            <input type="range" class="range-min" id="frequency-end-min" 
                                   min="80" max="800" step="1" value="220">
                            <input type="range" class="range-max" id="frequency-end-max" 
                                   min="80" max="800" step="1" value="220">
                            <div class="slider-track"></div>
                            <div class="slider-range"></div>
                        </div>
                        <span class="value-display" id="frequency-end-display">220</span>
                        <button class="randomizer-btn" id="frequency-end-randomizer" title="Toggle HRG">[ hrg ]</button>
                        <div class="param-value" id="frequency-end-value" style="display: none;">220</div>
                    </div>
                    
                    <!-- HRG Controls for frequency end (hidden by default) -->
                    <div class="hrg-controls hrg-compact" id="frequency-end-hrg-controls" style="display: none;">
                        <div class="hrg-inputs hrg-compact-inputs">
                            <div class="hrg-compact-line">
                                <span>n:</span><input type="text" id="frequency-end-numerators" value="1,2,3">
                                <select id="frequency-end-numerators-behavior">
                                    <option value="static">S</option>
                                    <option value="ascending">A</option>
                                    <option value="descending">D</option>
                                    <option value="shuffle">Sh</option>
                                    <option value="random">R</option>
                                </select>
                            </div>
                            <div class="hrg-compact-line">
                                <span>d:</span><input type="text" id="frequency-end-denominators" value="1,2">
                                <select id="frequency-end-denominators-behavior">
                                    <option value="static">S</option>
                                    <option value="ascending">A</option>
                                    <option value="descending">D</option>
                                    <option value="shuffle">Sh</option>
                                    <option value="random">R</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="envelope-controls">
                        <div class="envelope-type">
                            <label>type:</label>
                            <label><input type="radio" name="frequency-env-type" value="lin" checked> lin</label>
                            <label><input type="radio" name="frequency-env-type" value="cos"> cos</label>
                            <label><input type="radio" name="frequency-env-type" value="par"> par</label>
                        </div>
                        
                        <div class="envelope-intensity">
                            <label>intensity:</label>
                            <input type="range" class="slider small-slider" id="frequency-intensity" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <span class="param-value small" id="frequency-intensity-value">0.50</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="param-control envelope-control">
                <div class="param-header">
                    <div class="param-label">vowel x</div>
                    <label class="static-checkbox">
                        <input type="checkbox" id="vowelX-static" checked>
                        static
                    </label>
                </div>
                <div class="param-row">
                    <div class="param-label">start:</div>
                    <div class="dual-range-slider" data-mode="static" data-param="vowelX" data-type="start">
                        <input type="range" class="range-min" id="vowelX-start-min" 
                               min="0" max="1" step="0.01" value="0.5">
                        <input type="range" class="range-max" id="vowelX-start-max" 
                               min="0" max="1" step="0.01" value="0.5">
                        <div class="slider-track"></div>
                        <div class="slider-range"></div>
                    </div>
                    <span class="value-display" id="vowelX-start-display">0.50</span>
                </div>
                
                <!-- Envelope Controls (hidden when static) -->
                <div class="envelope-section" id="vowelX-envelope">
                    <div class="param-row">
                        <div class="param-label">end:</div>
                        <div class="dual-range-slider" data-mode="static" data-param="vowelX" data-type="end">
                            <input type="range" class="range-min" id="vowelX-end-min" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <input type="range" class="range-max" id="vowelX-end-max" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <div class="slider-track"></div>
                            <div class="slider-range"></div>
                        </div>
                        <span class="value-display" id="vowelX-end-display">0.50</span>
                    </div>
                    
                    <div class="envelope-controls">
                        <div class="envelope-type">
                            <label>type:</label>
                            <label><input type="radio" name="vowelX-env-type" value="lin" checked> lin</label>
                            <label><input type="radio" name="vowelX-env-type" value="cos"> cos</label>
                            <label><input type="radio" name="vowelX-env-type" value="par"> par</label>
                        </div>
                        
                        <div class="envelope-intensity">
                            <label>intensity:</label>
                            <input type="range" class="slider small-slider" id="vowelX-intensity" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <span class="param-value small" id="vowelX-intensity-value">0.50</span>
                        </div>
                        
                    </div>
                </div>
                
            </div>

            <div class="param-control envelope-control">
                <div class="param-header">
                    <div class="param-label">vowel y</div>
                    <label class="static-checkbox">
                        <input type="checkbox" id="vowelY-static" checked>
                        static
                    </label>
                </div>
                <div class="param-row">
                    <div class="param-label">start:</div>
                    <div class="dual-range-slider" data-mode="static" data-param="vowelY" data-type="start">
                        <input type="range" class="range-min" id="vowelY-start-min" 
                               min="0" max="1" step="0.01" value="0.5">
                        <input type="range" class="range-max" id="vowelY-start-max" 
                               min="0" max="1" step="0.01" value="0.5">
                        <div class="slider-track"></div>
                        <div class="slider-range"></div>
                    </div>
                    <span class="value-display" id="vowelY-start-display">0.50</span>
                </div>
                
                <!-- Envelope Controls (hidden when static) -->
                <div class="envelope-section" id="vowelY-envelope">
                    <div class="param-row">
                        <div class="param-label">end:</div>
                        <div class="dual-range-slider" data-mode="static" data-param="vowelY" data-type="end">
                            <input type="range" class="range-min" id="vowelY-end-min" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <input type="range" class="range-max" id="vowelY-end-max" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <div class="slider-track"></div>
                            <div class="slider-range"></div>
                        </div>
                        <span class="value-display" id="vowelY-end-display">0.50</span>
                    </div>
                    
                    <div class="envelope-controls">
                        <div class="envelope-type">
                            <label>type:</label>
                            <label><input type="radio" name="vowelY-env-type" value="lin" checked> lin</label>
                            <label><input type="radio" name="vowelY-env-type" value="cos"> cos</label>
                            <label><input type="radio" name="vowelY-env-type" value="par"> par</label>
                        </div>
                        
                        <div class="envelope-intensity">
                            <label>intensity:</label>
                            <input type="range" class="slider small-slider" id="vowelY-intensity" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <span class="param-value small" id="vowelY-intensity-value">0.50</span>
                        </div>
                        
                    </div>
                </div>
            </div>

            <div class="param-control envelope-control">
                <div class="param-header">
                    <div class="param-label">zing amount</div>
                    <label class="static-checkbox">
                        <input type="checkbox" id="zingAmount-static" checked>
                        static
                    </label>
                </div>
                <div class="param-row">
                    <div class="param-label">start:</div>
                    <div class="dual-range-slider" data-mode="static" data-param="zingAmount" data-type="start">
                        <input type="range" class="range-min" id="zingAmount-start-min" 
                               min="0" max="1" step="0.01" value="0">
                        <input type="range" class="range-max" id="zingAmount-start-max" 
                               min="0" max="1" step="0.01" value="0">
                        <div class="slider-track"></div>
                        <div class="slider-range"></div>
                    </div>
                    <span class="value-display" id="zingAmount-start-display">0.00</span>
                </div>
                
                <!-- Envelope Controls (hidden when static) -->
                <div class="envelope-section" id="zingAmount-envelope">
                    <div class="param-row">
                        <div class="param-label">end:</div>
                        <div class="dual-range-slider" data-mode="static" data-param="zingAmount" data-type="end">
                            <input type="range" class="range-min" id="zingAmount-end-min" 
                                   min="0" max="1" step="0.01" value="0">
                            <input type="range" class="range-max" id="zingAmount-end-max" 
                                   min="0" max="1" step="0.01" value="0">
                            <div class="slider-track"></div>
                            <div class="slider-range"></div>
                        </div>
                        <span class="value-display" id="zingAmount-end-display">0.00</span>
                    </div>
                    
                    <div class="envelope-controls">
                        <div class="envelope-type">
                            <label>type:</label>
                            <label><input type="radio" name="zingAmount-env-type" value="lin" checked> lin</label>
                            <label><input type="radio" name="zingAmount-env-type" value="cos"> cos</label>
                            <label><input type="radio" name="zingAmount-env-type" value="par"> par</label>
                        </div>
                        
                        <div class="envelope-intensity">
                            <label>intensity:</label>
                            <input type="range" class="slider small-slider" id="zingAmount-intensity" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <span class="param-value small" id="zingAmount-intensity-value">0.50</span>
                        </div>
                        
                    </div>
                </div>
            </div>

            <div class="param-control envelope-control">
                <div class="param-header">
                    <div class="param-label">zing morph</div>
                    <label class="static-checkbox">
                        <input type="checkbox" id="zingMorph-static" checked>
                        static
                    </label>
                </div>
                <div class="param-row">
                    <div class="param-label">start:</div>
                    <div class="dual-range-slider" data-mode="static" data-param="zingMorph" data-type="start">
                        <input type="range" class="range-min" id="zingMorph-start-min" 
                               min="0" max="1" step="0.01" value="0.5">
                        <input type="range" class="range-max" id="zingMorph-start-max" 
                               min="0" max="1" step="0.01" value="0.5">
                        <div class="slider-track"></div>
                        <div class="slider-range"></div>
                    </div>
                    <span class="value-display" id="zingMorph-start-display">0.50</span>
                </div>
                
                <!-- Envelope Controls (hidden when static) -->
                <div class="envelope-section" id="zingMorph-envelope">
                    <div class="param-row">
                        <div class="param-label">end:</div>
                        <div class="dual-range-slider" data-mode="static" data-param="zingMorph" data-type="end">
                            <input type="range" class="range-min" id="zingMorph-end-min" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <input type="range" class="range-max" id="zingMorph-end-max" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <div class="slider-track"></div>
                            <div class="slider-range"></div>
                        </div>
                        <span class="value-display" id="zingMorph-end-display">0.50</span>
                    </div>
                    
                    <div class="envelope-controls">
                        <div class="envelope-type">
                            <label>type:</label>
                            <label><input type="radio" name="zingMorph-env-type" value="lin" checked> lin</label>
                            <label><input type="radio" name="zingMorph-env-type" value="cos"> cos</label>
                            <label><input type="radio" name="zingMorph-env-type" value="par"> par</label>
                        </div>
                        
                        <div class="envelope-intensity">
                            <label>intensity:</label>
                            <input type="range" class="slider small-slider" id="zingMorph-intensity" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <span class="param-value small" id="zingMorph-intensity-value">0.50</span>
                        </div>
                        
                    </div>
                </div>
            </div>

            <div class="param-control envelope-control">
                <div class="param-header">
                    <div class="param-label">symmetry</div>
                    <label class="static-checkbox">
                        <input type="checkbox" id="symmetry-static" checked>
                        static
                    </label>
                </div>
                <div class="param-row">
                    <div class="param-label">start:</div>
                    <div class="dual-range-slider" data-mode="static" data-param="symmetry" data-type="start">
                        <input type="range" class="range-min" id="symmetry-start-min" 
                               min="0" max="1" step="0.01" value="0.5">
                        <input type="range" class="range-max" id="symmetry-start-max" 
                               min="0" max="1" step="0.01" value="0.5">
                        <div class="slider-track"></div>
                        <div class="slider-range"></div>
                    </div>
                    <span class="value-display" id="symmetry-start-display">0.50</span>
                </div>
                
                <!-- Envelope Controls (hidden when static) -->
                <div class="envelope-section" id="symmetry-envelope">
                    <div class="param-row">
                        <div class="param-label">end:</div>
                        <div class="dual-range-slider" data-mode="static" data-param="symmetry" data-type="end">
                            <input type="range" class="range-min" id="symmetry-end-min" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <input type="range" class="range-max" id="symmetry-end-max" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <div class="slider-track"></div>
                            <div class="slider-range"></div>
                        </div>
                        <span class="value-display" id="symmetry-end-display">0.50</span>
                    </div>
                    
                    <div class="envelope-controls">
                        <div class="envelope-type">
                            <label>type:</label>
                            <label><input type="radio" name="symmetry-env-type" value="lin" checked> lin</label>
                            <label><input type="radio" name="symmetry-env-type" value="cos"> cos</label>
                            <label><input type="radio" name="symmetry-env-type" value="par"> par</label>
                        </div>
                        
                        <div class="envelope-intensity">
                            <label>intensity:</label>
                            <input type="range" class="slider small-slider" id="symmetry-intensity" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <span class="param-value small" id="symmetry-intensity-value">0.50</span>
                        </div>
                        
                    </div>
                </div>
            </div>

            <div class="param-control envelope-control">
                <div class="param-header">
                    <div class="param-label">amplitude</div>
                    <label class="static-checkbox">
                        <input type="checkbox" id="amplitude-static" checked>
                        static
                    </label>
                </div>
                <div class="param-row">
                    <div class="param-label">start:</div>
                    <div class="dual-range-slider" data-mode="static" data-param="amplitude" data-type="start">
                        <input type="range" class="range-min" id="amplitude-start-min" 
                               min="0" max="1" step="0.01" value="1.0">
                        <input type="range" class="range-max" id="amplitude-start-max" 
                               min="0" max="1" step="0.01" value="1.0">
                        <div class="slider-track"></div>
                        <div class="slider-range"></div>
                    </div>
                    <span class="value-display" id="amplitude-start-display">1.00</span>
                </div>
                
                <!-- Envelope Controls (hidden when static) -->
                <div class="envelope-section" id="amplitude-envelope">
                    <div class="param-row">
                        <div class="param-label">end:</div>
                        <div class="dual-range-slider" data-mode="static" data-param="amplitude" data-type="end">
                            <input type="range" class="range-min" id="amplitude-end-min" 
                                   min="0" max="1" step="0.01" value="1.0">
                            <input type="range" class="range-max" id="amplitude-end-max" 
                                   min="0" max="1" step="0.01" value="1.0">
                            <div class="slider-track"></div>
                            <div class="slider-range"></div>
                        </div>
                        <span class="value-display" id="amplitude-end-display">1.00</span>
                    </div>
                    
                    <div class="envelope-controls">
                        <div class="envelope-type">
                            <label>type:</label>
                            <label><input type="radio" name="amplitude-env-type" value="lin" checked> lin</label>
                            <label><input type="radio" name="amplitude-env-type" value="cos"> cos</label>
                            <label><input type="radio" name="amplitude-env-type" value="par"> par</label>
                        </div>
                        
                        <div class="envelope-intensity">
                            <label>intensity:</label>
                            <input type="range" class="slider small-slider" id="amplitude-intensity" 
                                   min="0" max="1" step="0.01" value="0.5">
                            <span class="param-value small" id="amplitude-intensity-value">0.50</span>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>

        <!-- Row 1: Control Panel (narrow, right) -->
        <div class="panel narrow">
            <h2>control</h2>
            <div class="control-section">
                <h3>calibration</h3>
                <button class="button" id="calibration-btn">enable calibration mode</button>
            </div>
            <div class="control-section">
                <h3>parameters</h3>
                <button class="button" id="apply-params-btn" disabled>apply changes</button>
            </div>
            <div class="control-section">
                <h3>synthesis</h3>
                <button class="button manual-mode-btn" id="manual-mode-btn">enable synthesis</button>
            </div>
            <div class="control-section">
                <h3>es-8</h3>
                <button class="button" id="es8-enable-btn">enable es-8</button>
            </div>
        </div>

        <!-- Row 2: Phasor Panel (left) -->
        <div class="panel">
            <h2>phasor</h2>
            
            <div class="param-control">
                <div class="param-label">cpm</div>
                <div class="param-value" id="cpm-value">30 CPM</div>
                <input type="range" class="slider" id="cpm-slider" 
                       min="15" max="60" value="30" step="1">
            </div>

            <div class="param-control">
                <div class="param-label">steps per cycle</div>
                <div class="param-value" id="steps-per-cycle-value">16 steps</div>
                <input type="range" class="slider" id="steps-per-cycle-slider" 
                       min="4" max="32" value="16" step="1">
            </div>
            
            <div class="param-control">
                <div class="param-label">phase</div>
                <div class="phasor-value" id="phasor-display">0.000</div>
                <div class="phasor-bar-container">
                    <div class="phasor-bar" id="phasor-bar"></div>
                </div>
            </div>
        </div>

        <!-- Row 2: Future Envelope Visualizer Panel (center) -->
        <div class="panel">
            <h2>visualizer</h2>
            <div style="color: #888; font-size: 10px; text-align: center; padding: 20px;">
                envelope visualizer coming soon
            </div>
        </div>

        <!-- Row 2: Log Panel (right) -->
        <div class="panel">
            <h2>log</h2>
            <div class="log" id="debug-log"></div>
            <div class="control-section">
                <button class="button" id="clear-log-btn">clear</button>
            </div>
        </div>
    </div>

    <script type="module" src="/ctrl/ctrl-main.js"></script>
</body>
</html>